<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Companies House spreadsheet updater</title>
  </head>
  <body>
    <div id="app">
      <div id="info">
        <h2>Companies house spreadsheet updater</h2>
        <p>
          Generates Companies House advanced search links, so that you can<br>quickly download each CSV and feed them into this page as you go.<br><br>Then, at the end, it combines them all into one, just for you!
          <br><br>
          Simply keep following the instructions until you've exhausted them.
          <br><br>
          You might also have to make one successful manual search in another tab<br>
          in the same browser window first, to prime companies house for this<br>
          autosearch - otherwise, you might get empty responses.
          <br><br>
          <span class="smallDesc">
            (It's a multi-step process because otherwise Companies House would cut off<br>
            the results at 5000. Dividing the search into multiple queries addresses that.)<br>
            (and the actual API has been a bit uncooperative)
          </span>
          <br>
        </p>
      </div>
      <div id="steps">
        <h4 id="cur-step" style="margin-bottom:0;">Step 1 of ?</h4>
        <p id="instructions" style="margin-top:0;"></p>
        <input type="file" id="csv-file-upload">
        <br>
        <br>
        <button id="proceed-button">Proceed</button>
        <p id="error-message"></p>
        <p id="positive-message"></p>
        <button id="nothing-there-button">Click here if there were genuinely no results</button>
      </div>
    </div>
    <script type="module" src="./src/main.js"></script>
  </body>
</html>